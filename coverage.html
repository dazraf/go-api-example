
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>docs: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">github.com/dazraf/go-api-example/docs/docs.go (0.0%)</option>
				
				<option value="file1">github.com/dazraf/go-api-example/handlers/users.go (62.5%)</option>
				
				<option value="file2">github.com/dazraf/go-api-example/main.go (0.0%)</option>
				
				<option value="file3">github.com/dazraf/go-api-example/store/memory.go (100.0%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">// Package docs Code generated by swaggo/swag. DO NOT EDIT
package docs

import "github.com/swaggo/swag"

const docTemplate = `{
    "schemes": {{ marshal .Schemes }},
    "swagger": "2.0",
    "info": {
        "description": "{{escape .Description}}",
        "title": "{{.Title}}",
        "termsOfService": "http://swagger.io/terms/",
        "contact": {
            "name": "API Support",
            "url": "http://www.swagger.io/support",
            "email": "support@swagger.io"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        },
        "version": "{{.Version}}"
    },
    "host": "{{.Host}}",
    "basePath": "{{.BasePath}}",
    "paths": {
        "/users": {
            "get": {
                "description": "Get a list of all users",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "List users",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/store.User"
                            }
                        }
                    }
                }
            },
            "post": {
                "description": "Create a new user",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "Create a user",
                "parameters": [
                    {
                        "description": "User object",
                        "name": "user",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.User"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/store.User"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/main.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/users/{id}": {
            "get": {
                "description": "Get user by ID",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "Get a user",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "User ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.User"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/main.ErrorResponse"
                        }
                    }
                }
            },
            "put": {
                "description": "Update user by ID",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "Update a user",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "User ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "User object",
                        "name": "user",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.User"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.User"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/main.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/main.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "description": "Delete user by ID",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "users"
                ],
                "summary": "Delete a user",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "User ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No Content"
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/main.ErrorResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "main.ErrorResponse": {
            "type": "object",
            "properties": {
                "error": {
                    "type": "string",
                    "example": "User not found"
                }
            }
        },
        "store.User": {
            "type": "object",
            "properties": {
                "email": {
                    "type": "string",
                    "example": "john@example.com"
                },
                "id": {
                    "type": "integer",
                    "example": 1
                },
                "name": {
                    "type": "string",
                    "example": "John Doe"
                }
            }
        }
    }
}`

// SwaggerInfo holds exported Swagger Info so clients can modify it
var SwaggerInfo = &amp;swag.Spec{
        Version:          "1.0",
        Host:             "localhost:8080",
        BasePath:         "/api/v1",
        Schemes:          []string{},
        Title:            "User API",
        Description:      "A simple user management API",
        InfoInstanceName: "swagger",
        SwaggerTemplate:  docTemplate,
        LeftDelim:        "{{",
        RightDelim:       "}}",
}

func init() <span class="cov0" title="0">{
        swag.Register(SwaggerInfo.InstanceName(), SwaggerInfo)
}</span>
</pre>
		
		<pre class="file" id="file1" style="display: none">package handlers

import (
        "net/http"
        "strconv"

        "github.com/dazraf/go-api-example/store"
        "github.com/gin-gonic/gin"
)

type ErrorResponse struct {
        Error string `json:"error" example:"User not found"`
}

type UserHandler struct {
        userStore store.UserStore
}

func NewUserHandler(userStore store.UserStore) *UserHandler <span class="cov8" title="1">{
        return &amp;UserHandler{
                userStore: userStore,
        }
}</span>

// @Summary List users
// @Description Get a list of all users
// @Tags users
// @Accept json
// @Produce json
// @Success 200 {array} store.User
// @Router /users [get]
func (h *UserHandler) GetUsers(c *gin.Context) <span class="cov8" title="1">{
        users, err := h.userStore.GetAll()
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusInternalServerError, ErrorResponse{Error: err.Error()})
                return
        }</span>
        <span class="cov8" title="1">c.JSON(http.StatusOK, users)</span>
}

// @Summary Get a user
// @Description Get user by ID
// @Tags users
// @Accept json
// @Produce json
// @Param id path int true "User ID"
// @Success 200 {object} store.User
// @Failure 404 {object} ErrorResponse
// @Router /users/{id} [get]
func (h *UserHandler) GetUser(c *gin.Context) <span class="cov8" title="1">{
        idStr := c.Param("id")
        id, err := strconv.Atoi(idStr)
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusBadRequest, ErrorResponse{Error: "Invalid user ID"})
                return
        }</span>

        <span class="cov8" title="1">user, err := h.userStore.GetByID(id)
        if err != nil </span><span class="cov8" title="1">{
                c.JSON(http.StatusNotFound, ErrorResponse{Error: "User not found"})
                return
        }</span>

        <span class="cov8" title="1">c.JSON(http.StatusOK, user)</span>
}

// @Summary Create a user
// @Description Create a new user
// @Tags users
// @Accept json
// @Produce json
// @Param user body store.User true "User object"
// @Success 201 {object} store.User
// @Failure 400 {object} ErrorResponse
// @Router /users [post]
func (h *UserHandler) CreateUser(c *gin.Context) <span class="cov8" title="1">{
        var user store.User
        if err := c.ShouldBindJSON(&amp;user); err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusBadRequest, ErrorResponse{Error: err.Error()})
                return
        }</span>

        <span class="cov8" title="1">createdUser, err := h.userStore.Create(user)
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusInternalServerError, ErrorResponse{Error: err.Error()})
                return
        }</span>

        <span class="cov8" title="1">c.JSON(http.StatusCreated, createdUser)</span>
}

// @Summary Update a user
// @Description Update user by ID
// @Tags users
// @Accept json
// @Produce json
// @Param id path int true "User ID"
// @Param user body store.User true "User object"
// @Success 200 {object} store.User
// @Failure 400 {object} ErrorResponse
// @Failure 404 {object} ErrorResponse
// @Router /users/{id} [put]
func (h *UserHandler) UpdateUser(c *gin.Context) <span class="cov8" title="1">{
        idStr := c.Param("id")
        id, err := strconv.Atoi(idStr)
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusBadRequest, ErrorResponse{Error: "Invalid user ID"})
                return
        }</span>

        <span class="cov8" title="1">var user store.User
        if err := c.ShouldBindJSON(&amp;user); err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusBadRequest, ErrorResponse{Error: err.Error()})
                return
        }</span>

        <span class="cov8" title="1">updatedUser, err := h.userStore.Update(id, user)
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusNotFound, ErrorResponse{Error: "User not found"})
                return
        }</span>

        <span class="cov8" title="1">c.JSON(http.StatusOK, updatedUser)</span>
}

// @Summary Delete a user
// @Description Delete user by ID
// @Tags users
// @Accept json
// @Produce json
// @Param id path int true "User ID"
// @Success 204 "No Content"
// @Failure 404 {object} ErrorResponse
// @Router /users/{id} [delete]
func (h *UserHandler) DeleteUser(c *gin.Context) <span class="cov8" title="1">{
        idStr := c.Param("id")
        id, err := strconv.Atoi(idStr)
        if err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusBadRequest, ErrorResponse{Error: "Invalid user ID"})
                return
        }</span>

        <span class="cov8" title="1">if err := h.userStore.Delete(id); err != nil </span><span class="cov0" title="0">{
                c.JSON(http.StatusNotFound, ErrorResponse{Error: "User not found"})
                return
        }</span>

        <span class="cov8" title="1">c.Status(http.StatusNoContent)</span>
}</pre>
		
		<pre class="file" id="file2" style="display: none">package main

import (
        _ "github.com/dazraf/go-api-example/docs"
        "github.com/dazraf/go-api-example/handlers"
        "github.com/dazraf/go-api-example/store"
        "github.com/gin-gonic/gin"
        swaggerFiles "github.com/swaggo/files"
        ginSwagger "github.com/swaggo/gin-swagger"
)

// @title           User API
// @version         1.0
// @description     A simple user management API
// @termsOfService  http://swagger.io/terms/

// @contact.name   API Support
// @contact.url    http://www.swagger.io/support
// @contact.email  support@swagger.io

// @license.name  Apache 2.0
// @license.url   http://www.apache.org/licenses/LICENSE-2.0.html

// @host      localhost:8080
// @BasePath  /api/v1

func main() <span class="cov0" title="0">{
        // Initialize the user store with some sample data
        userStore := store.NewMemoryUserStore()
        
        // Add some initial users
        userStore.Create(store.User{Name: "John Doe", Email: "john@example.com"})
        userStore.Create(store.User{Name: "Jane Smith", Email: "jane@example.com"})

        // Create handler with dependency injection
        userHandler := handlers.NewUserHandler(userStore)

        router := gin.Default()

        v1 := router.Group("/api/v1")
        </span><span class="cov0" title="0">{
                v1.GET("/users", userHandler.GetUsers)
                v1.GET("/users/:id", userHandler.GetUser)
                v1.POST("/users", userHandler.CreateUser)
                v1.PUT("/users/:id", userHandler.UpdateUser)
                v1.DELETE("/users/:id", userHandler.DeleteUser)
        }</span>        // Swagger endpoint
        <span class="cov0" title="0">router.GET("/swagger/*any", ginSwagger.WrapHandler(swaggerFiles.Handler))

        router.Run(":8080")</span>
}

</pre>
		
		<pre class="file" id="file3" style="display: none">package store

import (
        "errors"
        "sync"
)

// MemoryUserStore is an in-memory implementation of UserStore
type MemoryUserStore struct {
        users  map[int]User
        nextID int
        mutex  sync.RWMutex
}

// NewMemoryUserStore creates a new in-memory user store
func NewMemoryUserStore() *MemoryUserStore <span class="cov8" title="1">{
        return &amp;MemoryUserStore{
                users:  make(map[int]User),
                nextID: 1,
        }
}</span>

// GetAll returns all users
func (m *MemoryUserStore) GetAll() ([]User, error) <span class="cov8" title="1">{
        m.mutex.RLock()
        defer m.mutex.RUnlock()

        users := make([]User, 0, len(m.users))
        for _, user := range m.users </span><span class="cov8" title="1">{
                users = append(users, user)
        }</span>
        <span class="cov8" title="1">return users, nil</span>
}

// GetByID returns a user by ID
func (m *MemoryUserStore) GetByID(id int) (*User, error) <span class="cov8" title="1">{
        m.mutex.RLock()
        defer m.mutex.RUnlock()

        user, exists := m.users[id]
        if !exists </span><span class="cov8" title="1">{
                return nil, errors.New("user not found")
        }</span>
        <span class="cov8" title="1">return &amp;user, nil</span>
}

// Create adds a new user and returns the created user with assigned ID
func (m *MemoryUserStore) Create(user User) (*User, error) <span class="cov8" title="1">{
        m.mutex.Lock()
        defer m.mutex.Unlock()

        user.ID = m.nextID
        m.nextID++
        m.users[user.ID] = user
        return &amp;user, nil
}</span>

// Update modifies an existing user
func (m *MemoryUserStore) Update(id int, user User) (*User, error) <span class="cov8" title="1">{
        m.mutex.Lock()
        defer m.mutex.Unlock()

        if _, exists := m.users[id]; !exists </span><span class="cov8" title="1">{
                return nil, errors.New("user not found")
        }</span>

        <span class="cov8" title="1">user.ID = id // Ensure ID matches the parameter
        m.users[id] = user
        return &amp;user, nil</span>
}

// Delete removes a user by ID
func (m *MemoryUserStore) Delete(id int) error <span class="cov8" title="1">{
        m.mutex.Lock()
        defer m.mutex.Unlock()

        if _, exists := m.users[id]; !exists </span><span class="cov8" title="1">{
                return errors.New("user not found")
        }</span>

        <span class="cov8" title="1">delete(m.users, id)
        return nil</span>
}
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
